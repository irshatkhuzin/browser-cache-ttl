"use strict";var l=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var h=Object.prototype.hasOwnProperty;var m=(n,e)=>{for(var t in e)l(n,t,{get:e[t],enumerable:!0})},f=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of u(e))!h.call(n,a)&&a!==t&&l(n,a,{get:()=>e[a],enumerable:!(r=d(e,a))||r.enumerable});return n};var g=n=>f(l({},"__esModule",{value:!0}),n);var v={};m(v,{CacheManager:()=>i,LocalStorageAdapter:()=>o,MemoryAdapter:()=>s});module.exports=g(v);var s=class{constructor(){this.store=new Map}get timeSecond(){return Math.floor(Date.now()/1e3)}set(e,t,r){let a=r?this.timeSecond+r:void 0;this.store.set(e,{value:t,expiresAt:a})}get(e){let t=this.store.get(e);return t?t.expiresAt&&t.expiresAt<this.timeSecond?(this.store.delete(e),null):t.value:null}delete(e){this.store.delete(e)}has(e){let t=this.store.get(e);return t?t.expiresAt&&t.expiresAt<this.timeSecond?(this.store.delete(e),!1):!0:!1}cleanupExpired(){for(let[e,t]of this.store.entries())t.expiresAt&&t.expiresAt<this.timeSecond&&this.store.delete(e)}destroy(){}};var o=class{get timeSecond(){return Math.floor(Date.now()/1e3)}set(e,t,r){let a=r?this.timeSecond+r:void 0,p={value:t,expiresAt:a};try{let c=JSON.stringify(p);localStorage.setItem(e,c)}catch(c){}}get(e){let t=localStorage.getItem(e);if(!t)return null;try{let r=JSON.parse(t);return r.expiresAt&&r.expiresAt<this.timeSecond?(this.delete(e),null):r.value}catch(r){return console.warn(`[LocalStorageAdapter] \u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0430\u0440\u0441\u0438\u043D\u0433\u0430 \u0434\u043B\u044F \u043A\u043B\u044E\u0447\u0430 "${e}":`,r),this.delete(e),null}}delete(e){localStorage.removeItem(e)}has(e){let t=localStorage.getItem(e);if(!t)return!1;try{let r=JSON.parse(t);return r.expiresAt&&r.expiresAt<this.timeSecond?(this.delete(e),!1):!0}catch(r){return this.delete(e),!1}}cleanupExpired(){for(let e=localStorage.length-1;e>=0;e--){let t=localStorage.key(e);if(!t)continue;let r=localStorage.getItem(t);if(r)try{let a=JSON.parse(r);a.expiresAt&&a.expiresAt<this.timeSecond&&localStorage.removeItem(t)}catch(a){localStorage.removeItem(t)}}}destroy(){}};var i=class n{constructor(e){this.cleanupIntervalId=null;this.cleanupIntervalMs=60*1e3;this.adapter=n.checkLocalStorage()?new o:new s,e!=null&&e.cleanupIntervalMs&&(this.cleanupIntervalMs=e.cleanupIntervalMs),this.startCleanupTask()}startCleanupTask(){this.cleanupIntervalId=setInterval(()=>{this.adapter.cleanupExpired()},this.cleanupIntervalMs)}static checkLocalStorage(){if(typeof localStorage=="undefined")return!1;try{let e="__test__";return localStorage.setItem(e,"1"),localStorage.removeItem(e),!0}catch(e){return!1}}set(e,t,r){this.adapter.set(e,t,r)}get(e){return this.adapter.get(e)}delete(e){this.adapter.delete(e)}has(e){return this.adapter.has(e)}destroy(){this.cleanupIntervalId&&(clearInterval(this.cleanupIntervalId),this.cleanupIntervalId=null)}};0&&(module.exports={CacheManager,LocalStorageAdapter,MemoryAdapter});
//# sourceMappingURL=index.js.map